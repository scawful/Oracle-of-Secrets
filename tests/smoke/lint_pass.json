{
  "name": "Static Analysis Lint Pass",
  "description": "Tier 1 lint: ensure metadata and hard-safety checks are in sync (no emulator required)",
  "version": "1.0",
  "tags": ["smoke", "lint", "static-analysis", "tier1"],
  "timeout_seconds": 60,
  "requiresEmulator": false,
  "steps": [
    {
      "type": "exec",
      "command": [
        "python3",
        "scripts/verify_feature_flags.py",
        "--root",
        "."
      ],
      "expectedExitCode": 0,
      "description": "Feature flags should be consistent"
    },
    {
      "type": "exec",
      "command": [
        "python3",
        "scripts/verify_hooks_json.py",
        "--root",
        ".",
        "--rom",
        "Roms/oos168x.sfc",
        "--hooks",
        "hooks.json"
      ],
      "expectedExitCode": 0,
      "description": "hooks.json should match generator output"
    },
    {
      "type": "exec",
      "command": [
        "python3",
        "scripts/validate_sprite_registry.py",
        "--strict"
      ],
      "expectedExitCode": 0,
      "description": "Sprite registry IDs should be up-to-date and valid"
    },
    {
      "type": "exec",
      "command": [
        "python3",
        "../z3dk/scripts/oracle_analyzer.py",
        "Roms/oos168x.sfc",
        "--hooks",
        "hooks.json",
        "--check-sprite-tables"
      ],
      "expectedExitCode": 0,
      "description": "Sprite property tables should not overflow past ID $F2"
    },
    {
      "type": "exec",
      "command": [
        "python3",
        "scripts/check_zscream_overlap.py"
      ],
      "expectedExitCode": 0,
      "description": "No ZScream overlaps should be detected"
    }
  ],
  "onFailure": {
    "expert": "nayru",
    "context": "Tier 1 lint failed. Fix the failing step (flags, hooks.json, sprite registry, or overlap check) before proceeding."
  }
}
